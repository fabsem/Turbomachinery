function [CHI_Ma] = traupel_Ma_naca65(M1,solidity,flag)

if flag == 0

%t/c 0.1 solidity 1
  x_data = [0.201624158900293; ...
            0.299525530997536; ...
            0.400899384087730; ...
            0.500870315057563; ...
            0.602428532131033; ...
            0.653751368097813; ...
            0.704092197599171; ...
            0.754789854323189; ...
            0.797669112497147];

  y_data = [0.907687295273064; ...
            0.902934801481937; ...
            0.951411798904744; ...
            1.02422874400330; ...
            1.17463853929099; ...
            1.28379762492367; ...
            1.42779402478606; ...
            1.68018734242082; ...
            2.05431941726675];

% t/c 0.1 solidity 0.8
  x_data08 = [%0.201124327656744; ...
              %0.299208405436884; ...
              %0.400975373263906; ...
              %0.501200609474163; ...
              %0.603150478078245; ...
              %0.655214281673050; ...
              %0.689156276276745; ...
              0.711903767853555; ...
              0.729865111896257; ...
              0.745897462410232; ...
              0.760256880483365; ...
              0.770349101493836; ...
              0.781713336441834];

  y_data08 = [%0.898002821061585; ...
              %0.905377380392647; ...
              %0.948980925643760; ...
              %1.02906707922579; ...
              %1.17379443188255; ...
              %1.29262628607698; ...
              %1.39211130252016; ...
              1.52450220098730; ...
              1.67735197393021; ...
              1.87479376921271; ...
              2.25840091720269; ...
              2.72716666699182; ...
              3.45477034490697];


  n = 6;
  n08 = 3;

  p = polyfit(x_data,y_data,n);
  p08 = polyfit(x_data08,y_data08,n08);

  x = linspace(0.2,0.8);
  x08 = linspace(0.7, 0.8);

  y_calc = polyval(p,x);
  y_calc08 = polyval(p08,x08);

  plot(x,y_calc,'r')
  hold on
  plot(x08,y_calc08,'k')
  plot(x_data,y_data,'r*')
  plot(x_data08,y_data08,'k*')
  legend('s = 1', 's = 0.8', 's = 1', 's = 0.8')

else
 %for n = 6, p is already available;
   p = [558.359616878116, ...
        -1583.99693972428, ...
        1830.68099456901, ...
        -1095.66524882629, ...
        357.923025307276, ...
        -60.1367922106622, ...
        4.92779089441352];

    % for n = 3, p08 is already available;
    p08 = [6602.25844580986, ...
         -14302.9377512206, ...
         10336.0593340825, ...
         -2490.00532158317];
if solidity >= 1

   CHI_Ma = polyval(p,M1);

elseif solidity < 1 && M1 < 0.71

    CHI_Ma = polyval(p,M1);

else
    CHI_Ma = polyval(p08,M1);

end
end
end
